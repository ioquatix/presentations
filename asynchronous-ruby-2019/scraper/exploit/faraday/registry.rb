#!/usr/bin/env ruby

require 'faraday/adapter_registry'

threads = []

registry = Faraday::AdapterRegistry.new

10.times do
	threads << Thread.new do
		while true
			name = ('A'..'Z').to_a.sample(6).join
			
			Object.const_set(name, name)
			
			value = registry.get(name)
			
			if value != name
				puts "#{value} != #{name}"
			end
		end
	end
end

threads.each(&:join)
